{% extends "base.html" %}
{% block content %}

<!--Profile usename display-->
<div class="row">
    <div class="col s8 offset-s2 center">
        <h2>{{ username }}'s Profile </h2>
    </div>

    <!--User settings FABs-->
    <div id="settings" class="col s1 offset-s1">
        <div class="fixed-action-btn direction-top direction-bottom active">

            <!--Main FAB which opens sub-setting buttons-->
            <a id="user-settings" class="btn-floating btn-large">
                <i class="fas fa-user-cog"></i>
            </a>
            <ul>
                <!--User edit settings button-->
                <li>
                    <a id="sub-setting1" class="btn-floating" href="{{ url_for('edit_user', username=session['user']) }}">
                        <i class="fas fa-user-edit"></i>
                    </a>
                </li>
                <!--User delete settings button-->
                <li>
                    <a id="sub-setting2" class="btn-floating">
                        <i class="fas fa-user-times"></i>
                    </a>
                </li>
            </ul>
        </div>
    </div>
</div>

<!--Section to display the session user's bookmarked books-->
<div class="container">
     <div class="row">
        <div class="col s12">
            <h3 class="book-title">My Reading List</h3>
        </div>
    </div>
    {% for book in bookmarked_books %}
    <ul id="reading-list" class="collapsible">
        <li>
            <div class="collapsible-header row">

                <!--Title and author display-->
                <div class="col s9">
                    <p>{{ book.title }}<small> &nbsp;&nbsp;&nbsp;{{ book.author }}</small></p>
                </div>
                
                <!--Mark as completed and remove from bookmarked list-->
                <div class="book-actions col s3 right-align">
                    <a id="remove-button" class="btn tooltipped" data-position="right"
                data-tooltip="Completed"  href="{{ url_for('unbookmark', book_id=book._id) }}">
                        <i class="fas fa-check"></i>
                    </a>
                </div>
            </div>

            <!--Collapsible section containing more info about book-->
            <div class="collapsible-body row">
                <div class="col s12 m6 center">
                    <p class="category-display">{{ book.category }}</p>
                    <p>{{ book.description }}</p>
                    <div class="row">

                        <!--Displays purchase link or an unavailable message-->
                        <div class="col s12">
                            {% if book.purchase_link %}
                                <a class="btn" href="{{ book.purchase_link }}" target="_blank">Buy Now</a>
                            {% else %}
                                <p class="grey-text lighten-2">Not Available</p>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <!--Image of book-->
                <div class="col s12 m6 center">
                    <img class="book-image-profile-page" src="{{book.image_url}}" alt="Image of {{book.title}}" width="200px" height="300px">
                </div>
            </div>
        </li>
    </ul>  

    <!--If user has not bookmarked any books, then following message and link to All Books page display-->
    {% else %}
    <div class="row">
        <div class="col s12 m4 offset-m4 center">
            <p>You have not saved any books to your reading list yet.</p>
        </div>
    </div>
    <div class="row">
        <div class="col s12 m2 offset-m5 center">

            <!--Link to All Books page-->
            <a id="create-reading-list-button" class="btn-floating btn-large waves-effect waves-light green"
                href="{{ url_for('all_books') }}">
                <i class="fas fa-plus"></i>
            </a>
        </div>
    </div>
    {% endfor %}  
</div>

<!--Section to display the books the session user has added to the db-->
<div class="container">
    <div class="row">
        <div class="col s12">
            <h3 class="book-title">My Recommendations</h3>
        </div>
    </div>
    {% for book in recommended_books %}
    <ul id="added-list" class="collapsible">
        <li>
            <div class="collapsible-header row">

                <!--Title and author display-->
                <div class="col s9">
                    <p>{{ book.title }}<small> &nbsp;&nbsp;&nbsp;{{ book.author }}</small></p>
                </div>

                <!--Edit and delete buttons-->
                <div class="book-actions col s3 right-align">
                    <a id="edit-button" class="btn tooltipped" data-position="left"
                data-tooltip="Edit" href="{{ url_for('edit_book', book_id=book._id) }}"><i class="fas fa-edit"></i></a>
                    <a id="delete-button" class="btn tooltipped" data-position="right"
                data-tooltip="Delete" href="{{ url_for('delete_book', book_id=book._id) }}"
                        onclick="
                        return confirm('Are you sure you want to delete {{ book.title }} from the database? This action will remove this book for all users and cannot be undone.');"><i class="fas fa-trash-alt"></i></a>
                </div>
            </div>

            <!--Collapsible section containing more info about book-->
            <div class="collapsible-body row">
                <div class="col s12 m6 center">

                    <!--Category and description-->
                    <p class="category-display">{{ book.category }}</p>
                    <p>{{ book.description }}</p>

                    <!--Purchase link-->
                    <div class="row">
                        <div class="col s12">
                            {% if book.purchase_link %}
                            <a class="btn" href="{{ book.purchase_link }}" target="_blank">Buy Now</a>
                            {% else %}
                            <p class="grey-text lighten-2">Not Available</p>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <!--Book image-->
                <div class="col s12 m6 center">
                    <img class="book-image-profile-page" src="{{ book.image_url }}" alt="Image of {{ book.title }}" width="200px" height="300px">
                </div>
            </div>
        </li>
    </ul>

    <!--Display of the user has not add any recommendations to the site yet-->
    {% else %}
    <div class="row">
        <div class="col s12 m4 offset-m4 center">
            <p>You have not added any recommendations to The Book Bunker yet.</p>
        </div>
    </div>

    <!--Add Book button-->
    <div class="row">
        <div class="col s12 m2 offset-m5 center">
            <a class="add-book-button btn-floating waves-effect waves-light green"
                href="{{ url_for('add_book') }}">
                <i class="fas fa-plus"></i>
            </a>
        </div>
    </div>
    {% endfor %}
</div>

{% endblock %}